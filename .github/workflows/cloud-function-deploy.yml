name: Deploy Cloud Function; on: { push: { branches: [main], paths: [functions/hello-world/**, .github/workflows/cloud-function-deploy.yml] }, workflow_dispatch: null }; permissions: { contents: read, id-token: write }; env: { PROJECT_ID: 857835268341, REGION: us-central1 }; jobs: { deploy: { runs-on: ubuntu-latest, steps: [{ name: Checkout, uses: actions/checkout@v4 }, { name: Authenticate to Google Cloud, uses: google-github-actions/auth@v2, with: { workload_identity_provider: projects/${{ env.PROJECT_ID }}/locations/global/workloadIdentityPools/github-actions-pool/providers/github-provider, service_account: github-actions@shreyolab.iam.gserviceaccount.com } }, { name: Set up Cloud SDK, uses: google-github-actions/setup-gcloud@v2 }, { name: Deploy Cloud Function, run: gcloud functions deploy hello-world --gen2 --runtime=go121 --region=${{ env.REGION }} --source=./functions/hello-world --entry-point=HelloWorld --trigger-http --allow-unauthenticated }] } }
